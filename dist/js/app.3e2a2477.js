(function(){"use strict";var t={3302:function(t,e,s){var a=s(5471),o=s(8505),n=s(7776),r=s(375),i=s(1689),d=s(8834),c=s(4808),l=s(7954),u=s(2585),f=s(7410),m=s(1735),_=function(){var t=this,e=t._self._c;return e(o.A,[t.isReady?t.isAuthenticated?t.isStudent?[e(n.A,{attrs:{color:"primary",dark:""}},[e(m.sw,[t._v("Student Portal")]),e(f.A),e(r.A,{attrs:{text:""},on:{click:t.logout}},[t._v("Logout")])],1),e(l.A,[e(c.A,{attrs:{fluid:""}},[e("StudentPortal")],1)],1)]:e(c.A,{staticClass:"fill-height d-flex justify-center align-center"},[e(i.A,[e(d.ri,[t._v("Error: Invalid user role")])],1)],1):e("LoginPage",{on:{"login-success":t.onLoginSuccess}}):e(c.A,{staticClass:"fill-height d-flex justify-center align-center"},[e(u.A,{attrs:{indeterminate:"",color:"primary"}})],1)],2)},h=[],g=s(5353),w=s(8230),p=s(3021),S=s(946),v=function(){var t=this,e=t._self._c;return e(c.A,{staticClass:"fill-height d-flex justify-center align-center",attrs:{fluid:""}},[e(i.A,{staticClass:"mx-auto",attrs:{"max-width":"400"}},[e(d.ri,{staticClass:"headline justify-center"},[t._v("Student Login")]),e(d.OQ,[e(w.A,{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e(S.A,{attrs:{label:"Student Code",rules:[t=>!!t||"Code is required"],outlined:"",dense:""},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}}),e(S.A,{attrs:{label:"Password",type:"password",rules:[t=>!!t||"Password is required"],outlined:"",dense:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e(r.A,{staticClass:"mt-4",attrs:{color:"primary",block:"",disabled:!t.valid||t.loading,loading:t.loading},on:{click:t.login}},[t._v(" Login ")])],1)],1),e(p.A,{attrs:{color:t.snackbarColor,timeout:"3000"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" ")])],1)],1)},b=[],k={name:"StudentLoginTest",data(){return{code:"",password:"",valid:!1,loading:!1,snackbar:!1,snackbarText:"",snackbarColor:"error"}},methods:{async login(){if(this.$refs.form.validate()){this.loading=!0;try{const t=await this.$axios.post("/student/login",{code:this.code,password:this.password});localStorage.setItem("student_token",t.data.token),this.snackbarText="Login successful!",this.snackbarColor="success",this.snackbar=!0,this.$store.commit("auth/setUser",{...t.data.student,role:"student"}),this.$emit("login-success"),console.log("Student logged in:",t.data.student)}catch(t){console.error(t),this.snackbarText=t.response?.data?.message||"Login failed",this.snackbarColor="error",this.snackbar=!0}finally{this.loading=!1}}}}},T=k,y=s(1656),A=(0,y.A)(T,v,b,!1,null,"8ee4f052",null),E=A.exports,P=s(3882),C=s(9456),O=function(){var t=this,e=t._self._c;return e(c.A,{attrs:{fluid:""}},[e(i.A,{staticClass:"mb-6"},[e(d.ri,[e(C.A,{attrs:{left:"",color:"primary"}},[t._v("mdi-account-school")]),t._v(" Student Information ")],1),t.student?e(d.OQ,[e("p",[e("strong",[t._v("Name:")]),t._v(" "+t._s(t.student.name))]),e("p",[e("strong",[t._v("Code:")]),t._v(" "+t._s(t.student.code))]),e("p",[e("strong",[t._v("Status:")]),t._v(" "+t._s(t.student.status))])]):e(d.OQ,[e(u.A,{attrs:{indeterminate:"",color:"primary"}})],1)],1),t.student?.course?e(i.A,{staticClass:"mb-6"},[e(d.ri,[t._v("Course Information")]),e(d.OQ,[e("p",[e("strong",[t._v("Course:")]),t._v(" "+t._s(t.student.course.name))]),e("p",[e("strong",[t._v("Start:")]),t._v(" "+t._s(t.formatDate(t.student.course_start_at)))]),e("p",[e("strong",[t._v("End:")]),t._v(" "+t._s(t.formatDate(t.student.course_end_at)))])])],1):t._e(),e(i.A,{staticClass:"mb-6"},[e(d.ri,[t._v(" Certificate "),e(f.A),e(P.A,{attrs:{color:t.student?.certificate_issued_at?"green":"grey",dark:""}},[t._v(" "+t._s(t.student?.certificate_issued_at?"Issued":"Not Issued")+" ")])],1),e(d.OQ,[t.student?.certificate_issued_at?e("p",[e("strong",[t._v("Issued At:")]),t._v(" "+t._s(t.formatDate(t.student.certificate_issued_at))+" ")]):t._e(),t.student?.certificate_issued_at?e(r.A,{attrs:{color:"primary"},on:{click:t.downloadCertificate}},[e(C.A,{attrs:{left:""}},[t._v("mdi-download")]),t._v(" Download PDF ")],1):e(r.A,{attrs:{color:"orange",disabled:""}},[t._v("Certificate Not Issued Yet")])],1)],1),e(i.A,{staticClass:"mb-6"},[e(d.ri,[t._v("Change Password")]),e(d.OQ,[e(w.A,{ref:"form",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e(S.A,{attrs:{label:"Current Password",type:"password",outlined:"",dense:""},model:{value:t.currentPassword,callback:function(e){t.currentPassword=e},expression:"currentPassword"}}),e(S.A,{attrs:{label:"New Password",type:"password",outlined:"",dense:""},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),e(S.A,{attrs:{label:"Confirm New Password",type:"password",outlined:"",dense:""},model:{value:t.confirmPassword,callback:function(e){t.confirmPassword=e},expression:"confirmPassword"}}),e(r.A,{staticClass:"mt-4",attrs:{color:"primary",loading:t.loading,disabled:!t.valid},on:{click:t.changePassword}},[t._v(" Change Password ")])],1)],1)],1),e(p.A,{attrs:{color:t.snackbarColor,timeout:"3000"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.snackbarText)+" ")])],1)},I=[],D=(s(4603),s(7566),s(8721),{name:"StudentPortal",data(){return{student:null,loading:!0,valid:!0,currentPassword:"",newPassword:"",confirmPassword:"",snackbar:!1,snackbarText:"",snackbarColor:"success"}},methods:{async fetchStudent(){this.loading=!0;try{const t=await this.$axios.get("/student/me");this.student=t.data.data}catch(t){console.error(t),this.showSnackbar("Failed to fetch student info","error")}finally{this.loading=!1}},formatDate(t){return t?new Date(t).toLocaleDateString():"-"},async downloadCertificate(){try{const t=await this.$axios.get("/student/certificate/download",{responseType:"blob"}),e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=e,s.setAttribute("download",`certificate_${this.student.code}.pdf`),document.body.appendChild(s),s.click(),s.remove()}catch(t){console.error(t),this.showSnackbar("Failed to download certificate","error")}},async changePassword(){if(this.newPassword&&this.currentPassword&&this.confirmPassword)if(this.newPassword===this.confirmPassword){this.loading=!0;try{const t=await this.$axios.post("/student/change-password",{current_password:this.currentPassword,new_password:this.newPassword,new_password_confirmation:this.confirmPassword});this.showSnackbar(t.data.message,"success"),this.currentPassword=this.newPassword=this.confirmPassword=""}catch(t){console.error(t),this.showSnackbar(t.response?.data?.message||"Password change failed","error")}finally{this.loading=!1}}else this.showSnackbar("New passwords do not match","error");else this.showSnackbar("Please fill all password fields","error")},showSnackbar(t,e="success"){this.snackbarText=t,this.snackbarColor=e,this.snackbar=!0}},mounted(){this.fetchStudent()}}),x=D,L=(0,y.A)(x,O,I,!1,null,null,null),N=L.exports,R={name:"App",components:{LoginPage:E,StudentPortal:N},computed:{...(0,g.L8)("auth",["isAuthenticated","isStudent","isReady"])},methods:{...(0,g.i0)("auth",["logoutStudent"]),onLoginSuccess(){console.log("Student logged in")},logout(){this.logoutStudent(),location.reload()}}},U=R,j=(0,y.A)(U,_,h,!1,null,"6325178f",null),$=j.exports,z=s(4335);z.A.defaults.baseURL="http://127.0.0.1:8000/api",z.A.interceptors.request.use(t=>{const e=localStorage.getItem("token"),s=localStorage.getItem("student_token");return s?t.headers.Authorization=`Bearer ${s}`:e&&(t.headers.Authorization=`Bearer ${e}`),t},t=>Promise.reject(t)),z.A.interceptors.response.use(t=>t,t=>(t.response&&401===t.response.status&&(console.warn("Token expired or unauthorized, logging out..."),localStorage.removeItem("token"),localStorage.removeItem("student_token"),window.location.reload()),Promise.reject(t)));var F=z.A,G=(s(8111),s(2489),s(1701),{namespaced:!0,state:{students:[],page:1,perPage:10,loading:!1,error:""},getters:{students:t=>t.students},mutations:{SET_STUDENTS(t,e){t.students=e.map(t=>({...t,showPassword:!1}))},ADD_STUDENT(t,e){t.students.unshift({...e,showPassword:!1})},UPDATE_STUDENT(t,e){const s=t.students.findIndex(t=>t.id===e.id);-1!==s&&t.students.splice(s,1,{...e,showPassword:!1})},REMOVE_STUDENT(t,e){t.students=t.students.filter(t=>t.id!==e)}},actions:{async fetchStudents({commit:t}){try{const e=await F.get("/students");t("SET_STUDENTS",e.data.data||[])}catch(e){console.error(e.response?.data||e)}},async addStudent({commit:t},e){const s=await F.post("/students",e);t("ADD_STUDENT",s.data.data)},async updateStudent({commit:t},e){const s=await F.put(`/students/${e.id}`,e);t("UPDATE_STUDENT",s.data.data)},async deleteStudent({commit:t},e){await F.delete(`/students/${e}`),t("REMOVE_STUDENT",e)}}}),M={namespaced:!0,state:{student:null,token:localStorage.getItem("student_token"),initialized:!1},getters:{isAuthenticated:t=>!!t.student,student:t=>t.student,studentName:t=>t.student?.name||"",isStudent:t=>"student"===t.student?.role,isReady:t=>t.initialized},mutations:{SET_STUDENT(t,e){t.student=e?{...e,role:"student"}:null},SET_TOKEN(t,e){t.token=e,e?F.defaults.headers.common.Authorization=`Bearer ${e}`:delete F.defaults.headers.common.Authorization},SET_INITIALIZED(t,e){t.initialized=e},LOGOUT(t){t.student=null,t.token=null,t.initialized=!0,delete F.defaults.headers.common.Authorization}},actions:{async loginStudent({commit:t,dispatch:e},s){const a=await F.post("/student/login",s),o=a.data.token;return localStorage.setItem("student_token",o),t("SET_TOKEN",o),await e("fetchStudentProfile"),!0},async fetchStudentProfile({commit:t,state:e}){try{if(!e.token)return void t("SET_INITIALIZED",!0);const s=await F.get("/student/me");t("SET_STUDENT",s.data.data)}catch(s){console.error("Fetch profile failed:",s),localStorage.removeItem("student_token"),t("LOGOUT")}finally{t("SET_INITIALIZED",!0)}},logoutStudent({commit:t}){localStorage.removeItem("student_token"),t("LOGOUT")}}},Q={namespaced:!0,state:{courses:[]},getters:{allCourses:t=>t.courses.map(t=>({...t,formattedStart:t.course_start_at?t.course_start_at.toLocaleDateString():"-",formattedEnd:t.course_end_at?t.course_end_at.toLocaleDateString():"-"})),completedCourses:t=>t.courses.filter(t=>"completed"===t.status).map(t=>({...t,formattedStart:t.course_start_at?t.course_start_at.toLocaleDateString():"-",formattedEnd:t.course_end_at?t.course_end_at.toLocaleDateString():"-"})),ongoingCourses:t=>t.courses.filter(t=>"ongoing"===t.status).map(t=>({...t,formattedStart:t.course_start_at?t.course_start_at.toLocaleDateString():"-",formattedEnd:t.course_end_at?t.course_end_at.toLocaleDateString():"-"}))},mutations:{SET_COURSES(t,e){t.courses=e}},actions:{async fetchMyCourses({commit:t}){try{const e=await F.get("/student/courses"),s=(e.data.data||[]).map(t=>({...t,course_start_at:t.course_start_at?new Date(t.course_start_at):null,course_end_at:t.course_end_at?new Date(t.course_end_at):null}));t("SET_COURSES",s)}catch(e){console.error("Failed to fetch courses:",e)}}}},K={namespaced:!0,state:{certificates:[]},getters:{certificateCount:t=>t.certificates.length},mutations:{SET_CERTIFICATES(t,e){t.certificates=e}},actions:{async fetchMyCertificates({commit:t}){const e=await F.get("/student/certificates");t("SET_CERTIFICATES",e.data)}}};a["default"].use(g.Ay);const B=new g.Ay.Store({modules:{students:G,studentAuth:M,studentCourses:Q,studentCertificates:K},state:{user:null,token:localStorage.getItem("token"),loading:!1,error:null},getters:{isAuthenticated:t=>!!t.token,currentUser:t=>t.user,loading:t=>t.loading,error:t=>t.error},mutations:{SET_LOADING(t,e){t.loading=e},SET_USER(t,e){t.user=e},SET_TOKEN(t,e){t.token=e},SET_ERROR(t,e){t.error=e},LOGOUT(t){t.user=null,t.token=null,t.error=null}},actions:{async login({commit:t,dispatch:e},{email:s,password:a}){t("SET_LOADING",!0),t("SET_ERROR",null);try{const o=await F.post("/login",{email:s,password:a});if(!o.data.status)return void t("SET_ERROR",o.data.message||"Login failed");const n=o.data.token;localStorage.setItem("token",n),t("SET_USER",o.data.user),t("SET_TOKEN",n),await e("students/fetchStudents",null,{root:!0})}catch(o){t("SET_ERROR",o.response?.data?.message||"Login failed")}finally{t("SET_LOADING",!1)}},async logout({commit:t}){try{await F.post("/logout")}catch(e){console.error("Logout API failed",e)}finally{localStorage.removeItem("token"),t("LOGOUT")}},async autoLogin({commit:t,dispatch:e}){const s=localStorage.getItem("token");s&&(t("SET_TOKEN",s),await e("students/fetchStudents",null,{root:!0}))}}});var q=B,Z=s(3691),V=s.n(Z);s(4301);a["default"].use(V());var Y=new(V())({theme:{dark:!1},icons:{iconfont:"mdi"}});a["default"].config.productionTip=!1,q.dispatch("auth/fetchStudentProfile"),new a["default"]({store:q,vuetify:Y,render:t=>t($)}).$mount("#app")}},e={};function s(a){var o=e[a];if(void 0!==o)return o.exports;var n=e[a]={exports:{}};return t[a].call(n.exports,n,n.exports,s),n.exports}s.m=t,function(){var t=[];s.O=function(e,a,o,n){if(!a){var r=1/0;for(l=0;l<t.length;l++){a=t[l][0],o=t[l][1],n=t[l][2];for(var i=!0,d=0;d<a.length;d++)(!1&n||r>=n)&&Object.keys(s.O).every(function(t){return s.O[t](a[d])})?a.splice(d--,1):(i=!1,n<r&&(r=n));if(i){t.splice(l--,1);var c=o();void 0!==c&&(e=c)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[a,o,n]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var o,n,r=a[0],i=a[1],d=a[2],c=0;if(r.some(function(e){return 0!==t[e]})){for(o in i)s.o(i,o)&&(s.m[o]=i[o]);if(d)var l=d(s)}for(e&&e(a);c<r.length;c++)n=r[c],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(l)},a=self["webpackChunkmy_dashboard"]=self["webpackChunkmy_dashboard"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],function(){return s(3302)});a=s.O(a)})();
//# sourceMappingURL=app.3e2a2477.js.map